
      <!DOCTYPE html>
      <html lang="en">
      <head>
          <meta charset="UTF-8">
          <meta name="viewport" content="width=device-width, initial-scale=1.0">
          <title>Python Flowchart</title>
          <style>
              /* --- FIX 1: Updated CSS for a solid, stationary tooltip --- */
              body, html { 
                  margin: 0; 
                  padding: 10px; 
                  height: 100%; 
                  background-color: var(--vscode-editor-background); 
                  cursor: default; 
              }
              .mermaid .clickable { 
                  cursor: pointer; 
              }
              #tooltip {
                  position: fixed; /* Use fixed positioning */
                  display: none;
                  padding: 10px 15px;
                  /* Use a solid, opaque background from the VS Code theme */
                  background-color: var(--vscode-side-bar-background, #252526);
                  border: 1px solid var(--vscode-widget-border, #303030);
                  border-radius: 6px;
                  font-family: var(--vscode-font-family);
                  font-size: var(--vscode-font-size);
                  color: var(--vscode-editor-foreground);
                  z-index: 100;
                  max-width: 400px;
                  /* Add a shadow to make it pop */
                  box-shadow: 0 5px 15px rgba(0,0,0,0.3);
              }
              #tooltip h4 { margin-top: 0; border-bottom: 1px solid var(--vscode-foreground); padding-bottom: 4px; }
              #tooltip p { margin-bottom: 0; }
          </style>
      </head>
      <body>
          <div id="tooltip"></div>
          <div class="mermaid">
            graph TD
    start1[Start]
    end2[End]
    call_repeat_greeting3[["Call: repeat_greeting()"]]
    for_loop5{{"For Loop: i in range(3)"}}
    call_greet7[["Call: greet(#quot;Leonardo#quot;)"]]
    if_cond9{"If: name"}
    expr11[["print(f#quot;Hell#quot;)"]]
    expr12[["print(#quot;Hello world#quot;)"]]
    next_iter13((Next))
    start1 --> call_repeat_greeting3
    call_repeat_greeting3 --> for_loop5
    for_loop5 -->|Each item| call_greet7
    call_greet7 --> if_cond9
    if_cond9 -->|True| expr11
    expr11 --> next_iter13
    if_cond9 -->|False| expr12
    expr12 --> next_iter13
    next_iter13 --> for_loop5
    for_loop5 -->|Done| end2
click for_loop5 setClickedNode
click call_greet7 setClickedNode
click if_cond9 setClickedNode
click expr11 setClickedNode
click expr12 setClickedNode
click next_iter13 setClickedNode

          </div>
          
          <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
          <script>
              // --- FIX 2: New JavaScript logic for stationary tooltips ---

              const tooltipData = {"for_loop5":"<h4>Context: repeat_greeting()</h4><p><strong>Docstring:</strong> Repeats the greeting three times.</p><p><strong>Variables in scope:</strong> None</p>","call_greet7":"<h4>Context: repeat_greeting()</h4><p><strong>Docstring:</strong> Repeats the greeting three times.</p><p><strong>Variables in scope:</strong> None</p>","if_cond9":"<h4>Context: greet()</h4><p><strong>Docstring:</strong> Prints a greeting message.</p><p><strong>Variables in scope:</strong> name</p>","expr11":"<h4>Context: greet()</h4><p><strong>Docstring:</strong> Prints a greeting message.</p><p><strong>Variables in scope:</strong> name</p>","expr12":"<h4>Context: greet()</h4><p><strong>Docstring:</strong> Prints a greeting message.</p><p><strong>Variables in scope:</strong> name</p>","next_iter13":"<h4>Context: repeat_greeting()</h4><p><strong>Docstring:</strong> Repeats the greeting three times.</p><p><strong>Variables in scope:</strong> None</p>"};
              const tooltipDiv = document.getElementById('tooltip');
              let lastClickedNodeId = null;

              // This function is called by Mermaid. It ONLY stores the ID.
              window.setClickedNode = function(nodeId) {
                lastClickedNodeId = nodeId;
              };

              // This general event listener handles the logic of showing/hiding the tooltip.
              document.addEventListener('click', function(e) {
                const clickedElement = e.target.closest('.clickable');

                if (clickedElement && lastClickedNodeId) {
                    // --- A flowchart node was clicked ---
                    const content = tooltipData[lastClickedNodeId];
                    if (content) {
                        tooltipDiv.innerHTML = content;
                        
                        // Get the position of the clicked node
                        const rect = clickedElement.getBoundingClientRect();
                        
                        // Position the tooltip to the right of the node
                        tooltipDiv.style.left = (rect.right + 10) + 'px';
                        tooltipDiv.style.top = rect.top + 'px';

                        tooltipDiv.style.display = 'block';
                    }
                    // Reset for the next click
                    lastClickedNodeId = null;
                } else {
                    // --- Clicked outside a node, so hide the tooltip ---
                    tooltipDiv.style.display = 'none';
                }
              }, true);

              // Initialize Mermaid with the required security level
              mermaid.initialize({
                  startOnLoad: true,
                  theme: document.body.classList.contains('vscode-dark') ? 'dark' : 'default',
                  flowchart: { useMaxWidth: true, htmlLabels: true },
                  securityLevel: 'loose' 
              });
          </script>
      </body>
      </html>